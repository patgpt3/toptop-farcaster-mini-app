import{PasskeyLinkInit as t,PasskeyAuthenticateInit as e,PasskeyRegisterInit as n,PasskeyAuthenticate as s,PasskeyRegister as a,PasskeyLink as i}from"@privy-io/public-api";class r{async generateRegistrationOptions(e){return await this._privyInternal.fetch(t,{body:{relying_party:e}})}async generateAuthenticationOptions(t){return await this._privyInternal.fetch(e,{body:{relying_party:t}})}async generateSignupOptions(t){return await this._privyInternal.fetch(n,{body:{relying_party:t}})}async loginWithPasskey(t,e,n){let a=await this._privyInternal.fetch(s,{body:{relying_party:n,challenge:e,authenticator_response:this._transformAuthenticationResponseToSnakeCase(t)}});return await this._privyInternal.session.updateWithTokensResponse(a),this._privyInternal.callbacks?.setUser?.(a.user),a}async signupWithPasskey(t,e){let n=await this._privyInternal.fetch(a,{body:{relying_party:e,authenticator_response:this._transformRegistrationResponseToSnakeCase(t)}});return await this._privyInternal.session.updateWithTokensResponse(n),this._privyInternal.callbacks?.setUser?.(n.user),n}async linkWithPasskey(t,e){return await this._privyInternal.fetch(i,{body:{relying_party:e,authenticator_response:this._transformRegistrationResponseToSnakeCase(t)}}),(await this._privyInternal.refreshSession()).user}_transformRegistrationResponseToSnakeCase(t){return{type:t.type,id:t.id,raw_id:t.rawId,response:{client_data_json:t.response.clientDataJSON,attestation_object:t.response.attestationObject,authenticator_data:t.response.authenticatorData||void 0,transports:t.response.transports||void 0,public_key:t.response.publicKey||void 0,public_key_algorithm:t.response.publicKeyAlgorithm||void 0},authenticator_attachment:t.authenticatorAttachment||void 0,client_extension_results:{app_id:t.clientExtensionResults.appid||void 0,cred_props:t.clientExtensionResults.credProps||void 0,hmac_create_secret:t.clientExtensionResults.hmacCreateSecret||void 0}}}_transformAuthenticationResponseToSnakeCase(t){return{type:t.type,id:t.id,raw_id:t.rawId,response:{signature:t.response.signature,client_data_json:t.response.clientDataJSON,authenticator_data:t.response.authenticatorData,user_handle:t.response.userHandle||void 0},authenticator_attachment:t.authenticatorAttachment||void 0,client_extension_results:{app_id:t.clientExtensionResults.appid||void 0,cred_props:t.clientExtensionResults.credProps||void 0,hmac_create_secret:t.clientExtensionResults.hmacCreateSecret||void 0}}}constructor(t){this._privyInternal=t}}export{r as default};
