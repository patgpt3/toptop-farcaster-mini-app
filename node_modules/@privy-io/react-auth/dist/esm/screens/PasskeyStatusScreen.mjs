import{jsxs as o,Fragment as r,jsx as t}from"react/jsx-runtime";import{useState as e,useRef as n,useEffect as s}from"react";import{styled as i}from"styled-components";import{PrimaryButton as c}from"../components/Button.mjs";import{FixedGappedContainer as a}from"../components/Layouts.mjs";import{ConnectionLoader as m}from"../components/Loader.mjs";import{ModalFooter as p}from"../components/ModalFooter.mjs";import{ModalHeader as l}from"../components/ModalHeader.mjs";import h from"../components/layout/StackedContainer.mjs";import{DEFAULT_SUCCESS_SCREEN_DURATION_MS as u}from"../constants.mjs";import{PrivyError as d,PrivyErrorCode as j}from"../errors.mjs";import{usePrivyInternal as f}from"../hooks/internal-context.mjs";import{usePrivyModal as y}from"../hooks/modal-context.mjs";import{FingerPrint as g}from"../svg/fingerprint.mjs";import"../svg/protected-by-privy.mjs";import"@heroicons/react/24/outline/ArrowLeftIcon";import"@heroicons/react/24/outline/ArrowRightIcon";import"@heroicons/react/24/outline/QuestionMarkCircleIcon";import"@heroicons/react/24/outline/XMarkIcon";import"../configuration/context.mjs";import"../config.mjs";import"../configuration/defaultClientConfig.mjs";import"../configuration/login-methods.mjs";import"../configuration/wallets.mjs";import"../connectors/chains/index.mjs";import"../connectors/chains/arbitrum.mjs";import"../connectors/chains/arbitrumSepolia.mjs";import"../connectors/chains/avalanche.mjs";import"../connectors/chains/avalancheFuji.mjs";import"../connectors/chains/base.mjs";import"../connectors/chains/baseSepolia.mjs";import"../connectors/chains/berachainArtio.mjs";import"../connectors/chains/celo.mjs";import"../connectors/chains/celoAlfajores.mjs";import"../connectors/chains/filecoin.mjs";import"../connectors/chains/filecoinCalibration.mjs";import"../connectors/chains/garnetHolesky.mjs";import"../connectors/chains/holesky.mjs";import"../connectors/chains/linea.mjs";import"../connectors/chains/lineaTestnet.mjs";import"../connectors/chains/lukso.mjs";import"../connectors/chains/mainnet.mjs";import"../connectors/chains/optimism.mjs";import"../connectors/chains/optimismSepolia.mjs";import"../connectors/chains/polygon.mjs";import"../connectors/chains/polygonAmoy.mjs";import"../connectors/chains/redstone.mjs";import"../connectors/chains/sepolia.mjs";import"../connectors/chains/zora.mjs";import"../connectors/chains/zoraSepolia.mjs";import"../connectors/chains/zoraTestnet.mjs";import"../connectors/chains/utils.mjs";import"../lib/solana/index.mjs";import"../theme.mjs";import"tinycolor2";import"../lib/cybr53.mjs";import"../hooks/index.mjs";import"ofetch";import"../components/PrefetchedImage.mjs";import"./index.mjs";const k=()=>{let{lastScreen:i,currentScreen:k,navigateBack:w,data:x}=y(),{loginWithPasskey:b,signupWithPasskey:C,closePrivyModal:S}=f(),{passkeySignupFlow:A}=x?.passkeyAuthModalData??{},[I,P]=e("loading"),[E,M]=e(null),T=n([]);s((()=>()=>{T.current.forEach((o=>clearTimeout(o))),T.current=[]}),[]);let L=async()=>{P("loading");try{A?await C():await b(),P("success")}catch(o){M(o),P("error")}};return s((()=>{var o;"success"===I&&(o=setTimeout((()=>{S({shouldCallAuthOnSuccess:!0,isSuccess:!0})}),u),T.current=[o,...T.current])}),[I]),s((()=>{L()}),[]),/*#__PURE__*/o(r,{children:[/*#__PURE__*/t(l,{backFn:i&&k!==i?w:void 0}),/*#__PURE__*/o(v,{children:[/*#__PURE__*/t(h,{children:/*#__PURE__*/o("div",{children:[/*#__PURE__*/t(m,{success:"success"===I,fail:"error"===I}),/*#__PURE__*/t(g,{style:{width:"38px",height:"38px"}})]})}),/*#__PURE__*/o(a,{children:[/*#__PURE__*/t("h3",{children:(()=>{switch(I){case"loading":return"Waiting for passkey";case"success":return"Success";case"error":return"Something went wrong"}})()}),/*#__PURE__*/t("p",{style:{whiteSpace:"pre-wrap"},children:(()=>{switch(I){case"loading":return A?"Please follow prompts to register your passkey.":"Please follow prompts to verify your passkey.\nYou will have to sign up with another method first to register a passkey for your account.";case"success":return"You've successfully logged in with your passkey.";case"error":if(E instanceof d){if(E.privyErrorCode===j.CANNOT_LINK_MORE_OF_TYPE)return"Cannot link more passkeys to account.";if(E.privyErrorCode===j.PASSKEY_NOT_ALLOWED)return"Passkey request timed out or rejected by user.\nYou will have to sign up with another method first to register a passkey for your account."}return"An unknown error occurred.\nYou will have to sign up with another method first to register a passkey for your account."}})()})]}),(()=>{switch(I){case"loading":case"success":/*#__PURE__*/return t(c,{onClick:()=>{},disabled:!0,children:"Continue"});case"error":/*#__PURE__*/return t(c,{onClick:L,disabled:!1,children:"Retry"})}})()]}),/*#__PURE__*/t(p,{})]})};let v=/*#__PURE__*/i.div.withConfig({displayName:"Container",componentId:"sc-aab4a512-0"})(["display:flex;flex-direction:column;align-items:center;justify-content:center;gap:24px;width:100%;"]);const w=/*#__PURE__*/i.div.withConfig({displayName:"DoubleIconWrapper",componentId:"sc-aab4a512-1"})(["display:flex;align-items:center;justify-content:center;width:180px;height:90px;border-radius:50%;svg + svg{margin-left:12px;}> svg{z-index:2;color:var(--privy-color-accent) !important;stroke:var(--privy-color-accent) !important;fill:var(--privy-color-accent) !important;}"]);export{w as DoubleIconWrapper,k as PasskeyStatusScreen};
